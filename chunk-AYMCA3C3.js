import{d as R}from"./chunk-DHEXM2DX.js";import{l as y}from"./chunk-NDTEPHHI.js";import{k as oe,l as C,o as se,p as v,t as le,x as ce}from"./chunk-BE45KCKU.js";import{$ as s,$a as Q,A as u,Aa as c,Ba as P,Bb as ne,Cb as ae,D as W,E as r,Ia as D,Ib as N,J as S,K as T,Ka as I,Kb as re,Ma as g,Nb as j,R as p,S as F,Ta as G,Ua as H,Xa as J,Ya as E,Za as V,da as Y,ga as _,la as U,lb as K,pb as X,qb as Z,s as $,sa as b,ta as w,ub as ee,wa as O,wb as te,xa as k,xb as L,ya as d,yb as ie,za as l}from"./chunk-GEUL6SEO.js";import{a as m,b as q,e as f}from"./chunk-6MDQTQU3.js";var z={formId:"language",components:[{name:"Input",key:"name",focused:!0,props:{placeholder:"Enter language name ...",label:"Language name"}}]};var Re={formId:"phrase",title:"Phrase",components:[{name:"Input",key:"text",props:{label:"Origin text",placeholder:"Enter origin text...",type:"textarea",disabled:!0}},{name:"Input",key:"translation",focused:!0,props:{label:"Translation",placeholder:"Enter translation text...",type:"textarea"}}]};var A=(()=>{class t extends v{constructor(){super({name:"translatelanguage",unauthorized:!0}),this.language=p(void 0),this.languages=p(this.getDocs()),this._storeService=r(se),this._emitterService=r(C),this._languageId=p(null),this.loaded.subscribe({next:()=>{this.languages.set(this.getDocs()),this._loadLocal()}}),this.get().subscribe(()=>{this.languages.set(this.getDocs()),this._loadLocal()}),this._emitterService.on("translatelanguage_changed").subscribe(()=>{this.languages.set(this.getDocs())}),F(()=>{let e=this._languageId(),i=this.languages();if(!e||!i.length){this.language.set(void 0);return}let n=i.find(a=>a._id===e);n&&(this.language.set(n),this._storeService.set("languageId",e),this._emitterService.emit("languageId",e))})}setLanguageId(e=null){this._languageId.set(e)}setLanguage(e){e?._id&&this._languageId.set(e._id)}nextLanguage(){let e=this.getDocs();if(e.length>1){let i=this.language(),n=i?e.findIndex(a=>a._id===i._id):0;this.setLanguage(n===e.length-1?e[0]:e[n+1])}else this._languageId.set(null)}_loadLocal(){return f(this,null,function*(){let e=yield this._storeService.get("languageId");e&&this._languageId.set(e)})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Ze=(()=>{class t extends oe{constructor(e){super(z,r(y),e,"language"),this.configType="local",this._languageService=r(A),this._form=r(y),this._cdr=r(ae),this.searchable=L(!0),this.clearable=L(!0),this.disabled=L(!1),this.isMutatable=L(!1),this.wModel=ne(null,{alias:"wModel"}),this.wChange=te(),this.placeholder=ee(()=>(this.documents().length?"Select language":"Create new language")+"..."),this.buttons=p([]),this._languageService.loaded.pipe($(1)).subscribe(()=>{this.setDocuments()}),F(()=>{if(this._languageService.language()?._id&&this.wModel.set(this._languageService.language()?._id),this.isMutatable()){let i=!!this._languageService.language()?._id;this.buttons.set([{icon:i?"edit":"",click:()=>this.mutate(!0)},{icon:i?"delete":"",click:()=>this.deleteCurrent()},{icon:"add",click:()=>this.mutate(!1)}])}this._cdr.markForCheck()})}mutate(e=!0){let i=this.wModel()??null,n=e?this._languageService.getSignal(i):void 0;console.log(n?.()||{}),this._form.modal(z,{label:e?"Update":"Create",click:(a,M)=>{e&&this._languageService.language()?this._languageService.update(m(m({},this._languageService.language()),a)).subscribe(()=>{this.setDocuments()}):this._languageService.create(a).subscribe(h=>{this.setDocuments(),this._languageService.setLanguage(h),this.wModel.set(h._id),this.wChange.emit(h._id)}),M()}},n?.()||{})}deleteCurrent(){let e=this._languageService.language();e&&(this._languageService.languages().length>1?(this._languageService.nextLanguage(),console.log(this._languageService.language()),this.wModel.set(this._languageService.language()?._id)):this._languageService.setLanguageId(),this._languageService.delete(e).subscribe(()=>{this.setDocuments()}))}static{this.\u0275fac=function(i){return new(i||t)(Y(A))}}static{this.\u0275cmp=_({type:t,selectors:[["language-selector"]],inputs:{searchable:[1,"searchable"],clearable:[1,"clearable"],disabled:[1,"disabled"],isMutatable:[1,"isMutatable"],wModel:[1,"wModel"]},outputs:{wModel:"wModelChange",wChange:"wChange"},features:[U],decls:2,vars:9,consts:[[3,"wChange","placeholder","disabled","searchable","clearable","buttons","wModel","items"]],template:function(i,n){if(i&1){let a=D();l(0,"wselect",0),X(1,"translate"),I("wChange",function(h){return S(a),n.wModel.set(h),T(n.wChange.emit(h))}),c()}if(i&2){let a=n.documents();d("placeholder",Z(1,7,n.placeholder()))("disabled",n.disabled()||!a.length)("searchable",n.searchable())("clearable",n.clearable())("buttons",n.buttons())("wModel",n.wModel())("items",a)}},dependencies:[R,le],encapsulation:2,changeDetection:0})}}return t})();var me=(()=>{class t extends v{constructor(){super({name:"translatephrase",unauthorized:!0}),this.phrases=p(this.getDocs()),this._phrasesByText={},this._creating={},this._syncPending=!1,this._initialized=!1,this._emitter=r(C),this.ready=new Promise(e=>{this._readyResolve=e}),this.filteredDocuments(this._phrasesByText,{field:"text",filtered:()=>this._scheduleSync()}),this.get().subscribe(()=>{this._scheduleSync(),this._initialized=!0,this._readyResolve?.()})}getByText(e){return this._phrasesByText[e]?.[0]}hasText(e){return!!this.getByText(e)}ensurePhrase(e){return f(this,null,function*(){if(e){if(!this._initialized)try{yield this.ready}catch(i){return}this.hasText(e)||this._creating[e]||(this._creating[e]=!0,this.create({text:e}).subscribe({error:()=>{delete this._creating[e]},complete:()=>{delete this._creating[e]}}))}})}_scheduleSync(){this._syncPending||(this._syncPending=!0,queueMicrotask(()=>{this._syncPending=!1,this.phrases.set(this.getDocs()),this._emitter.emit("translatephrase_changed")}))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var pe=(()=>{class t extends v{constructor(){super({name:"translate",unauthorized:!0,replace:e=>{e.slug=e.phrase+e.language}}),this._phraseService=r(me),this._emitterService=r(C),this._translates={},this._signalTranslates={},this._languageId="",this._recalcPending=!1,this._recalcInProgress=!1,this.filteredDocuments(this._translates,{field:"slug",filtered:()=>this._scheduleRecalc()}),this._emitterService.on("languageId").subscribe(e=>{this.loadTranslate(e)}),this._emitterService.on("translatephrase_changed").subscribe(()=>this._scheduleRecalc())}loadTranslate(e){this._languageId!==e&&(this._languageId=e,this.get({query:"language="+e}).subscribe(()=>{this._scheduleRecalc()}))}translate(e){return this._signalTranslates[e]||(this._signalTranslates[e]=p(this._getTranslation(e)),queueMicrotask(()=>{this._phraseService.ensurePhrase(e)})),this._signalTranslates[e]}updateTranslation(e,i,n){return f(this,null,function*(){let a=yield this.getDoc(M=>M.language===n&&M.phrase===i);a?(a.text=e,a.text!==e&&this.update(a)):this.create({language:n,phrase:i,text:e})})}_scheduleRecalc(){this._recalcPending||(this._recalcPending=!0,queueMicrotask(()=>{this._recalcPending=!1,this._reTranslateNow()}))}_reTranslateNow(){if(!this._recalcInProgress){this._recalcInProgress=!0;try{for(let e of Object.keys(this._signalTranslates)){let i=this._getTranslation(e);this._signalTranslates[e]()!==i&&this._signalTranslates[e].set(i)}}finally{this._recalcInProgress=!1}}}_getTranslation(e){let i=this._phraseService.getByText(e);if(i&&this._languageId){let n=i._id+this._languageId,a=this._translates[n];if(a?.length)return a[0].text}return e}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var fe=["alertRef"],_e=t=>({"animation-duration":t}),be=(t,o)=>o.text;function we(t,o){if(t&1&&(l(0,"div",4),P(1,"span",12),c()),t&2){let e=g(2);s(),E((e.type==="info"?"bg-sky-300":"")+(e.type==="success"?" bg-emerald-300":"")+(e.type==="warning"?" bg-amber-300":"")+(e.type==="error"?" bg-rose-300":"")+(e.type==="question"?" bg-yellow-300":"")),d("ngStyle",K(3,_e,(e.timeout+350)/1e3+"s"))}}function Ce(t,o){if(t&1&&P(0,"div",13),t&2){let e=g(2);E(e.icon)}}function ve(t,o){if(t&1){let e=D();l(0,"button",15),I("wClick",function(){let n=S(e).$implicit,a=g(3);return T(a.remove(n.callback))}),V(1),c()}if(t&2){let e=o.$implicit;s(),Q(" ",e.text," ")}}function ye(t,o){if(t&1&&(l(0,"div",10),O(1,ve,2,1,"button",14,be),c()),t&2){let e=g(2);s(),k(e.buttons)}}function xe(t,o){if(t&1){let e=D();l(0,"button",16),I("wClick",function(){S(e);let n=g(2);return T(n.remove())}),V(1," close "),c()}}function Me(t,o){if(t&1&&(l(0,"div",2)(1,"div",3,0),b(3,we,2,5,"div",4),l(4,"div",5)(5,"div",6)(6,"div",7),b(7,Ce,1,2,"div",8),l(8,"div",9),V(9),c()(),b(10,ye,3,0,"div",10),c(),b(11,xe,2,0,"button",11),c()()()),t&2){let e=g();J("opacity-0",e.delete_animation),d("ngClass",e.class),s(),E("rounded-lg "+(e.type==="info"?"bg-sky-200/90 border-sky-200/90 text-slate-800":"")+(e.type==="success"?"bg-emerald-200/90 border-emerald-200/90 text-slate-800":"")+(e.type==="warning"?"bg-amber-200/90 border-amber-200/90 text-slate-800":"")+(e.type==="error"?"bg-rose-200/90 border-rose-200/90 text-slate-800":"")+(e.type==="question"?"bg-yellow-200/90 border-yellow-200/90 text-slate-800":"")),s(2),w(e.progress?3:-1),s(4),w(e.icon?7:-1),s(2),Q(" ",e.text," "),s(),w(e.type==="question"?10:-1),s(),w(e.closable?11:-1)}}var ue=(()=>{class t{constructor(){this.alertRef=ie("alertRef"),this.type="info",this.position="bottom",this.delete_animation=!1,this.buttons=[],this._timer=null,this._start=0,this._remaining=0,this._onEnter=()=>{this._timer&&(window.clearTimeout(this._timer),this._timer=null),this._remaining-=Date.now()-this._start},this._onLeave=()=>{this._start=Date.now(),this._timer&&window.clearTimeout(this._timer),this._timer=window.setTimeout(()=>this.remove(),this._remaining)},this._removed=!1}ngAfterViewInit(){let e=this.alertRef();if(!e||!this.timeout)return;this._remaining=this.timeout,this._start=Date.now(),this._timer=window.setTimeout(()=>this.remove(),this._remaining);let i=e.nativeElement;i.addEventListener("mouseenter",this._onEnter,!1),i.addEventListener("mouseleave",this._onLeave,!1)}ngOnDestroy(){let e=this.alertRef();if(this._timer&&window.clearTimeout(this._timer),this._timer=null,e){let i=e.nativeElement;i.removeEventListener("mouseenter",this._onEnter,!1),i.removeEventListener("mouseleave",this._onLeave,!1)}}remove(e){this._removed||(this._removed=!0,e?.(),this.delete_animation=!0,setTimeout(()=>{this.close(),this.delete_animation=!1},350))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=_({type:t,selectors:[["alert"]],viewQuery:function(i,n){i&1&&G(n.alertRef,fe,5),i&2&&H()},decls:1,vars:1,consts:[["alertRef",""],[1,"max-w-full","opacity-100","transition-all","duration-300","ease-in-out",3,"opacity-0","ngClass"],[1,"max-w-full","opacity-100","transition-all","duration-300","ease-in-out",3,"ngClass"],[1,"relative","pointer-events-auto","select-none","text-sm","min-h-10","max-w-full","px-4","py-2","border","shadow-sm","animate-alert-bounce-in-up"],[1,"absolute","left-0","bottom-0","w-full"],[1,"flex","items-center","gap-3","w-full"],[1,"flex-1","min-w-0","flex","items-center","justify-between","gap-3"],[1,"flex","items-center","gap-2","min-w-0"],["aria-hidden","true",3,"class"],[1,"min-w-0","break-words","text-[14px]","leading-4","animate-alert-slide-in"],[1,"flex","items-center","gap-2","flex-none"],["wbutton","","type","button","aria-label","Close alert",1,"material-icons","flex-none","!h-7","!w-7","!rounded-full","!p-0","opacity-60","hover:opacity-100"],[1,"block","h-[2px]","w-full","rounded-full","animate-alert-progress",3,"ngStyle"],["aria-hidden","true"],["wbutton","","type","button",1,"!h-8","!px-3","!text-xs"],["wbutton","","type","button",1,"!h-8","!px-3","!text-xs",3,"wClick"],["wbutton","","type","button","aria-label","Close alert",1,"material-icons","flex-none","!h-7","!w-7","!rounded-full","!p-0","opacity-60","hover:opacity-100",3,"wClick"]],template:function(i,n){i&1&&b(0,Me,12,10,"div",1),i&2&&w(n.text?0:-1)},dependencies:[j,N,re],styles:["@keyframes _ngcontent-%COMP%_alert-bounce-in-up{0%{opacity:0;transform:translateY(200px)}50%{opacity:1;transform:translateY(-10px)}70%{transform:translateY(5px)}to{transform:translateY(0)}}@keyframes _ngcontent-%COMP%_alert-progress{0%{width:100%}to{width:0%}}.animate-alert-bounce-in-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_alert-bounce-in-up .7s ease-in-out both}.animate-alert-progress[_ngcontent-%COMP%]{animation-name:_ngcontent-%COMP%_alert-progress;animation-timing-function:linear;animation-fill-mode:both}.animate-alert-slide-in[_ngcontent-%COMP%]{animation:iziT-slideIn 1s cubic-bezier(.16,.81,.32,1) both}.animate-alert-bounce-in-up[_ngcontent-%COMP%]:hover   .animate-alert-progress[_ngcontent-%COMP%]{animation-play-state:paused}@media(prefers-reduced-motion:reduce){.animate-alert-bounce-in-up[_ngcontent-%COMP%], .animate-alert-slide-in[_ngcontent-%COMP%], .animate-alert-progress[_ngcontent-%COMP%]{animation:none!important}}"],changeDetection:0})}}return t})();var Se=(t,o)=>o.id;function Te(t,o){if(t&1&&P(0,"div",1),t&2){let e=o.$implicit;d("ngClass",e.class)("id",e.id)}}var de=(()=>{class t{constructor(){this.positions=[{id:"topLeft",class:"alert-lib-wrapper__alert--top-left"},{id:"top",class:"alert-lib-wrapper__alert--top"},{id:"topRight",class:"alert-lib-wrapper__alert--top-right"},{id:"left",class:"alert-lib-wrapper__alert--left"},{id:"center",class:"alert-lib-wrapper__alert--center"},{id:"right",class:"alert-lib-wrapper__alert--right"},{id:"bottomLeft",class:"alert-lib-wrapper__alert--bottom-left"},{id:"bottom",class:"alert-lib-wrapper__alert--bottom"},{id:"bottomRight",class:"alert-lib-wrapper__alert--bottom-right"}]}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=_({type:t,selectors:[["lib-wrapper"]],decls:3,vars:0,consts:[[1,"alert-lib-wrapper"],[1,"fixed","w-full","pointer-events-none","flex","flex-col","z-[99999]",3,"ngClass","id"]],template:function(i,n){i&1&&(l(0,"div",0),O(1,Te,1,2,"div",1,Se),c()),i&2&&(s(),k(n.positions))},dependencies:[j,N],styles:[".alert-lib-wrapper[_ngcontent-%COMP%]   .alert-lib-wrapper__alert--top-left[_ngcontent-%COMP%]{top:0;left:0;align-items:flex-start}.alert-lib-wrapper[_ngcontent-%COMP%]   .alert-lib-wrapper__alert--top[_ngcontent-%COMP%]{top:0;left:0;right:0;align-items:center}.alert-lib-wrapper[_ngcontent-%COMP%]   .alert-lib-wrapper__alert--top-right[_ngcontent-%COMP%]{top:0;right:0;align-items:flex-end}.alert-lib-wrapper[_ngcontent-%COMP%]   .alert-lib-wrapper__alert--left[_ngcontent-%COMP%]{top:0;bottom:0;left:0;justify-content:center;align-items:flex-start}.alert-lib-wrapper[_ngcontent-%COMP%]   .alert-lib-wrapper__alert--center[_ngcontent-%COMP%]{inset:0;justify-content:center;align-items:center}.alert-lib-wrapper[_ngcontent-%COMP%]   .alert-lib-wrapper__alert--right[_ngcontent-%COMP%]{top:0;bottom:0;right:0;justify-content:center;align-items:flex-end}.alert-lib-wrapper[_ngcontent-%COMP%]   .alert-lib-wrapper__alert--bottom-left[_ngcontent-%COMP%]{bottom:0;left:0;align-items:flex-start}.alert-lib-wrapper[_ngcontent-%COMP%]   .alert-lib-wrapper__alert--bottom[_ngcontent-%COMP%]{bottom:0;left:0;right:0;align-items:center}.alert-lib-wrapper[_ngcontent-%COMP%]   .alert-lib-wrapper__alert--bottom-right[_ngcontent-%COMP%]{bottom:0;right:0;align-items:flex-end}@media(max-width:567px){.alert-lib-wrapper[_ngcontent-%COMP%]   .fixed[_ngcontent-%COMP%]{left:0;right:0;align-items:center}.alert-lib-wrapper[_ngcontent-%COMP%]   .alert-lib-wrapper__alert--center[_ngcontent-%COMP%]{align-items:stretch}}"],changeDetection:0})}}return t})();var B={text:"",type:"info",class:"",progress:!0,position:"bottom",timeout:3e3,closable:!0,buttons:[]};var zt=(()=>{class t{constructor(e){this._dom=e,this._translateService=r(pe),this._alerts=[],this._config=q(m({},B),{position:"bottomRight"}),this._positionNumber={topLeft:0,top:1,topRight:2,left:3,center:4,right:5,bottomLeft:6,bottom:7,bottomRight:8},this._container=this._dom.appendComponent(de)}show(e){if(e=this._opts(e),e.text&&(e.text=this._translateService.translate(e.text)()),e.unique&&this._alerts.find(a=>a.unique===e.unique))return this._alerts.find(a=>a.unique===e.unique);this._alerts.push(e),e.id||=Math.floor(Math.random()*Date.now())+Date.now(),e.type||(e.type="info"),e.position||(e.position="bottomRight");let i,n;return e.close=()=>{n?.remove(),i?.remove(),n=void 0,i=void 0,typeof e.onClose=="function"&&e.onClose?.(),this._alerts.splice(this._alerts.findIndex(a=>a.id===e.id),1)},i=this._dom.appendById(ue,e,e.position),typeof e.component=="function"&&(n=this._dom.appendComponent(e.component,e,this._container.nativeElement.children[0].children[this._positionNumber[e.position]||0])),typeof e.timeout!="number"&&(e.timeout=B.timeout??3e3),e}open(e){this.show(e)}info(e){e=this._opts(e),e.type="info",this.show(e)}success(e){e=this._opts(e),e.type="success",this.show(e)}warning(e){e=this._opts(e),e.type="warning",this.show(e)}error(e){e=this._opts(e),e.type="error",this.show(e)}question(e){e=this._opts(e),e.type="question",this.show(e)}destroy(){for(let e=this._alerts.length-1;e>=0;e--)this._alerts[e].close?.()}setConfig(e){this._config=m(m({},this._config),e)}_opts(e){return typeof e=="string"?q(m({},this._config),{text:e}):m(m({},this._config),e)}static{this.\u0275fac=function(i){return new(i||t)(W(ce))}}static{this.\u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();export{Re as a,A as b,Ze as c,me as d,pe as e,zt as f};
